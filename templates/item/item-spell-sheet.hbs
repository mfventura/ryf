<form class="{{cssClass}} flexcol" autocomplete="off">

  <header class="sheet-header spell-header">
    <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}" height="48" width="48"/>
    <div class="header-fields">
      <input name="name" type="text" value="{{item.name}}" placeholder="{{localize 'RYF.SpellName'}}" class="spell-name-input"/>
    </div>
  </header>

  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="details">{{localize "RYF.Tabs.Details"}}</a>
    <a class="item" data-tab="description">{{localize "RYF.Tabs.Description"}}</a>
  </nav>

  <section class="sheet-body">

    <div class="tab description" data-group="primary" data-tab="description">
      <div class="editor-content">
        {{editor system.description target="system.description" button=true owner=owner editable=editable}}
      </div>
    </div>

    <div class="tab details" data-group="primary" data-tab="details">

      <h3>{{localize "RYF.BasicInfo"}}</h3>

      <div class="form-grid">
        <div class="form-group">
          <label>{{localize "RYF.Level"}}</label>
          <input type="number" name="system.level" value="{{system.level}}" data-dtype="Number" min="1" max="10"/>
        </div>

        <div class="form-group">
          <label>{{localize "RYF.ManaCost"}}</label>
          <input type="number" name="system.manaCost" value="{{system.manaCost}}" data-dtype="Number" min="0"/>
        </div>

        <div class="form-group">
          <label>{{localize "RYF.Magic.CastingDifficulty"}}</label>
          <input type="number" name="system.castingDifficulty" value="{{system.castingDifficulty}}" data-dtype="Number" min="5" max="30"/>
        </div>

        <div class="form-group">
          <label>{{localize "RYF.School"}}</label>
          <input type="text" name="system.school" value="{{system.school}}" placeholder="{{localize 'RYF.Evocation'}}"/>
        </div>

        <div class="form-group">
          <label>{{localize "RYF.CastingTime"}}</label>
          <input type="text" name="system.castingTime" value="{{system.castingTime}}" placeholder="{{localize 'RYF.Action'}}"/>
        </div>
      </div>

      <h3>{{localize "RYF.RangeAndTargets"}}</h3>

      <div class="form-grid">
        <div class="form-group">
          <label>{{localize "RYF.RangeType"}}</label>
          <select name="system.range.type" data-dtype="String" class="range-type-select">
            <option value="self" {{#if (eq system.range.type "self")}}selected{{/if}}>{{localize "RYF.RangeTypes.self"}}</option>
            <option value="touch" {{#if (eq system.range.type "touch")}}selected{{/if}}>{{localize "RYF.RangeTypes.touch"}}</option>
            <option value="ranged" {{#if (eq system.range.type "ranged")}}selected{{/if}}>{{localize "RYF.RangeTypes.ranged"}}</option>
          </select>
        </div>

        {{#if (eq system.range.type "ranged")}}
        <div class="form-group range-distance">
          <label>{{localize "RYF.MaxDistance"}}</label>
          <input type="number" name="system.range.maxDistance" value="{{system.range.maxDistance}}" data-dtype="Number" min="0"/>
        </div>
        {{/if}}

        <div class="form-group">
          <label>{{localize "RYF.TargetType"}}</label>
          <select name="system.targets.type" data-dtype="String" class="target-type-select">
            <option value="single" {{#if (eq system.targets.type "single")}}selected{{/if}}>{{localize "RYF.TargetTypes.single"}}</option>
            <option value="multiple" {{#if (eq system.targets.type "multiple")}}selected{{/if}}>{{localize "RYF.TargetTypes.multiple"}}</option>
            <option value="area" {{#if (eq system.targets.type "area")}}selected{{/if}}>{{localize "RYF.TargetTypes.area"}}</option>
          </select>
        </div>

        {{#if (eq system.targets.type "multiple")}}
        <div class="form-group target-count">
          <label>{{localize "RYF.TargetCount"}}</label>
          <input type="number" name="system.targets.count" value="{{system.targets.count}}" data-dtype="Number" min="1"/>
        </div>
        {{/if}}

        {{#if (eq system.targets.type "area")}}
        <div class="form-group target-area">
          <label>{{localize "RYF.AreaRadius"}}</label>
          <input type="number" name="system.targets.areaRadius" value="{{system.targets.areaRadius}}" data-dtype="Number" min="0"/>
        </div>
        {{/if}}
      </div>


      <h3>{{localize "RYF.SpellEffects"}}</h3>

      <div class="effects-list">
        {{#each system.effects as |effect index|}}
        <div class="effect-item" data-effect-index="{{index}}">
          <div class="effect-header">
            <button type="button" class="effect-collapse" data-effect-index="{{index}}">
              <i class="fas fa-chevron-down"></i>
            </button>
            <select name="system.effects.{{index}}.type" data-dtype="String" class="effect-type-select">
              <option value="immediate-damage" {{#if (eq effect.type "immediate-damage")}}selected{{/if}}>{{localize "RYF.EffectTypes.ImmediateDamage"}}</option>
              <option value="immediate-healing" {{#if (eq effect.type "immediate-healing")}}selected{{/if}}>{{localize "RYF.EffectTypes.ImmediateHealing"}}</option>
              <option value="buff" {{#if (eq effect.type "buff")}}selected{{/if}}>{{localize "RYF.EffectTypes.Buff"}}</option>
              <option value="debuff" {{#if (eq effect.type "debuff")}}selected{{/if}}>{{localize "RYF.EffectTypes.Debuff"}}</option>
              <option value="condition" {{#if (eq effect.type "condition")}}selected{{/if}}>{{localize "RYF.EffectTypes.Condition"}}</option>
            </select>
            <div class="effect-summary">
              {{#if (eq effect.type "immediate-damage")}}
                <span class="summary-type">{{localize "RYF.EffectTypes.ImmediateDamage"}}:</span>
                <span class="summary-details">{{effect.formula}} {{localize (concat "RYF.DamageTypes." (capitalize effect.damageType))}}{{#if effect.requiresAttack}} - {{localize "RYF.RequiresAttack"}}{{/if}}{{#if effect.savingThrow.enabled}} - {{localize "RYF.SavingThrow"}}{{/if}}</span>
              {{else if (eq effect.type "immediate-healing")}}
                <span class="summary-type">{{localize "RYF.EffectTypes.ImmediateHealing"}}:</span>
                <span class="summary-details">{{effect.formula}}</span>
              {{else if (eq effect.type "buff")}}
                <span class="summary-type">{{localize "RYF.EffectTypes.Buff"}}:</span>
                <span class="summary-details">{{localize (concat "RYF.EffectTargets." (capitalize effect.target))}}{{#if effect.targetName}} ({{effect.targetName}}){{/if}} +{{effect.modifier}} - {{effect.duration.value}} {{localize (concat "RYF.DurationTypes." (capitalize effect.duration.type))}}</span>
              {{else if (eq effect.type "debuff")}}
                <span class="summary-type">{{localize "RYF.EffectTypes.Debuff"}}:</span>
                <span class="summary-details">{{localize (concat "RYF.EffectTargets." (capitalize effect.target))}}{{#if effect.targetName}} ({{effect.targetName}}){{/if}} {{effect.modifier}} - {{effect.duration.value}} {{localize (concat "RYF.DurationTypes." (capitalize effect.duration.type))}}{{#if effect.savingThrow.enabled}} - {{localize "RYF.SavingThrow"}}{{/if}}</span>
              {{else if (eq effect.type "condition")}}
                <span class="summary-type">{{localize "RYF.EffectTypes.Condition"}}:</span>
                <span class="summary-details">{{localize (concat "RYF.Conditions." (capitalize effect.condition))}} - {{effect.duration.value}} {{localize (concat "RYF.DurationTypes." (capitalize effect.duration.type))}}{{#if effect.savingThrow.enabled}} - {{localize "RYF.SavingThrow"}}{{/if}}</span>
              {{/if}}
            </div>
            <button type="button" class="effect-delete" data-effect-index="{{index}}">
              <i class="fas fa-trash"></i>
            </button>
          </div>

          <div class="effect-config">
            {{#if (eq effect.type "immediate-damage")}}
              {{> "systems/ryf3/templates/item/partials/effect-immediate-damage.hbs" effect=effect index=index}}
            {{else if (eq effect.type "immediate-healing")}}
              {{> "systems/ryf3/templates/item/partials/effect-immediate-healing.hbs" effect=effect index=index}}
            {{else if (eq effect.type "buff")}}
              {{> "systems/ryf3/templates/item/partials/effect-buff.hbs" effect=effect index=index}}
            {{else if (eq effect.type "debuff")}}
              {{> "systems/ryf3/templates/item/partials/effect-debuff.hbs" effect=effect index=index}}
            {{else if (eq effect.type "condition")}}
              {{> "systems/ryf3/templates/item/partials/effect-condition.hbs" effect=effect index=index}}
            {{/if}}
          </div>
        </div>
        {{/each}}

        <button type="button" class="effect-add">
          <i class="fas fa-plus"></i> {{localize "RYF.AddEffect"}}
        </button>
      </div>

      {{#if actor}}
      <div class="form-group">
        <button type="button" class="spell-cast">
          <i class="fas fa-magic"></i> {{localize "RYF.CastSpell"}}
        </button>
      </div>
      {{/if}}

    </div>

  </section>
</form>
